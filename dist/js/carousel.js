/*! formstone v1.4.3 [carousel.js] 2018-02-03 | GPL-3.0 License | formstone.it */
!function(e){"function"==typeof define&&define.amd?define(["jquery","./core","./mediaquery","./touch"],e):e(jQuery,Formstone)}(function(e,t){"use strict";function i(){N=e(X.base)}function a(e){e.enabled&&(H.clearTimer(e.autoTimer),e.enabled=!1,e.$subordinate.off(O.update),this.removeClass([L.enabled,L.animated].join(" ")).off(O.namespace),e.$canister.fsTouch("destroy").off(O.namespace).attr("style","").css(E,"none"),e.$items.css({width:"",height:""}).removeClass([L.visible,X.item_previous,X.item_next].join(" ")),e.$images.off(O.namespace),e.$controlItems.off(O.namespace),e.$pagination.html("").off(O.namespace),h(e),e.$canister.css(z,""),e.index=0)}function n(e){e.enabled||(e.enabled=!0,this.addClass(L.enabled),e.$controlItems.on(O.click,e,p),e.$pagination.on(O.click,X.page,e,g),e.$items.on(O.click,e,I),e.$subordinate.on(O.update,e,W),W({data:e},0),e.$canister.fsTouch({axis:"x",pan:!0,swipe:!0}).on(O.panStart,e,b).on(O.pan,e,x).on(O.panEnd,e,w).on(O.swipe,e,P).on(O.focusIn,e,_).css(E,""),o(e),e.$images.on(O.load,e,u),e.autoAdvance&&(e.autoTimer=H.startTimer(e.autoTimer,e.autoTime,function(){m(e)},!0)),s.call(this,e))}function s(e){if(e.enabled){var t,i,a,n,s,o,r;if(e.count=e.$items.length,e.count<1)return h(e),void e.$canister.css({height:""});this.removeClass(L.animated),e.$canister.find(".carousel-clone").remove(),e.containerWidth=e.$container.outerWidth(!1),e.visible=C(e),e.perPage=e.paged?1:e.visible,e.itemMarginLeft=parseInt(e.$items.eq(0).css("marginLeft")),e.itemMarginRight=parseInt(e.$items.eq(0).css("marginRight")),e.itemMargin=e.itemMarginLeft+e.itemMarginRight,isNaN(e.itemMargin)&&(e.itemMargin=0),e.itemWidth=(e.containerWidth-e.itemMargin*(e.visible-1))/e.visible,e.itemHeight=0,e.pageWidth=e.paged?e.itemWidth:e.containerWidth,e.pageCount=Math.ceil(e.count/e.perPage),e.$items.css({width:e.matchWidth?e.itemWidth:"",height:""}).removeClass([L.visible,L.item_previous,L.item_next].join(" ")),e.pages=[];for(i=0,0;i<e.count;i+=e.perPage){for(s=0,o=0,(n=e.$items.slice(i,i+e.perPage)).length<e.perPage&&(n=0===i?e.$items:e.$items.slice(e.$items.length-e.perPage)),a=0;a<n.length;a++)s+=n.eq(a).outerWidth(!0),(t=n.eq(a).outerHeight())>o&&(o=t);e.pages.push({height:o,width:s,$items:n}),s,o>e.itemHeight&&(e.itemHeight=o),0}if(e.indexOffset=0,e.infinite){e.indexOffset=2;var l,c=e.pages.length-1,d=[],u=[];for(i=0;i<e.indexOffset;i++)l={height:e.pages[i].height,width:e.pages[i].width,$items:e.pages[i].$items.clone().addClass("carousel-clone")},u.push(l),l.width,e.$canister.append(l.$items);for(i=c;i>c-2;i--)l={height:e.pages[i].height,width:e.pages[i].width,$items:e.pages[i].$items.clone().addClass("carousel-clone")},d.push(l),l.width,e.$canister.prepend(l.$items);e.pages=d.concat(e.pages),e.pages=e.pages.concat(u),e.canisterWidth=e.single?e.containerWidth:(e.pageWidth+e.itemMargin)*(e.pageCount+2*e.indexOffset),e.$canister.css({width:e.matchWidth?e.canisterWidth:1e6,height:""})}for(i=0;i<e.pages.length;i++)r=(e.rtl?e.pages[i].$items.eq(e.pages[i].$items.length-1):e.pages[i].$items.eq(0)).position().left,e.pages[i].left=r;e.paged&&(e.pageCount=e.count-e.visible+1),e.pageCount<=0&&(e.pageCount=1),e.minClone=-e.pages[e.indexOffset].left,e.maxClone=-e.pages[e.pageCount+e.indexOffset-1].left,e.maxMove=-e.pages[e.pageCount+2*e.indexOffset-1].left,e.autoHeight?e.$canister.css({height:e.pages[0].height}):e.matchHeight&&e.$items.css({height:e.itemHeight});var m="";for(i=0;i<e.pageCount;i++)m+='<button type="button" class="'+L.page+'">'+(i+1)+"</button>";e.$pagination.html(m),e.pageCount<=1?h(e):v(e),e.$paginationItems=e.$pagination.find(X.page),f(e,e.index,!1),setTimeout(function(){e.$el.addClass(L.animated)},5)}}function o(e){e.$items=e.$canister.children().not(":hidden").addClass(L.item),e.$images=e.$canister.find("img"),e.totalImages=e.$images.length}function r(e,t){e.$images.off(O.namespace),!1!==t&&e.$canister.html(t),e.index=0,o(e),s.call(this,e)}function l(e,t,i,a,n){e.enabled&&(H.clearTimer(e.autoTimer),void 0===n&&(n=!0),f(e,t-1,n,i,a))}function c(e){var t=e.index-1;e.infinite&&t<0&&(t=e.pageCount-1),f(e,t)}function d(e){var t=e.index+1;e.infinite&&t>=e.pageCount&&(t=0),f(e,t)}function u(e){var t=e.data;t.resizeTimer=H.startTimer(t.resizeTimer,1,function(){s.call(t.$el,t)})}function m(e){var t=e.index+1;t>=e.pageCount&&(t=0),f(e,t)}function p(t){H.killEvent(t);var i=t.data,a=i.index+(e(t.currentTarget).hasClass(L.control_next)?1:-1);H.clearTimer(i.autoTimer),f(i,a)}function g(t){H.killEvent(t);var i=t.data,a=i.$paginationItems.index(e(t.currentTarget));H.clearTimer(i.autoTimer),f(i,a)}function f(t,i,a,n,s){var o=!1;if(i<0&&(i=t.infinite?t.pageCount-1:0,t.infinite)){r=t.$canister.css(z).split(",");t.leftPosition=parseInt(r[4]),o=t.leftPosition-t.pages[t.pageCount].left}if(i>=t.pageCount&&(i=t.infinite?0:t.pageCount-1,t.infinite)){var r=t.$canister.css(z).split(",");t.leftPosition=parseInt(r[4]),o=t.leftPosition+t.pages[t.pageCount].left}if(t.$canister.css(E,"0s"),console.log(o),o&&(t.leftPosition=o,t.useMargin?t.$canister.css({marginLeft:t.leftPosition}):t.$canister.css(z,"translateX("+t.leftPosition+"px)")),!(t.count<1)){i+=t.indexOffset,t.pages[i]&&(t.leftPosition=-t.pages[i].left),t.leftPosition=k(t,t.leftPosition),t.animationTimeout&&(clearTimeout(t.animationTimeout),t.animationTimeout=null),t.animationTimeout=setTimeout(function(){!1!==a&&t.$canister.css(E,"0.25s"),t.$canister.css(z,"translateX("+t.leftPosition+"px)")},50),t.$items.removeClass([L.visible,L.item_previous,L.item_next].join(" "));for(var l=0,c=t.pages.length;l<c;l++)l===i?t.pages[l].$items.addClass(L.visible).attr("aria-hidden","false"):t.pages[l].$items.not(t.pages[i].$items).addClass(l<i?L.item_previous:L.item_next).attr("aria-hidden","true");t.autoHeight&&t.$canister.css({height:t.pages[i].height}),!1!==a&&!0!==n&&i!==t.index&&(t.infinite||i>-1&&i<t.pageCount)&&t.$el.trigger(O.update,[i]),t.index=i-t.indexOffset,t.linked&&!0!==s&&e(t.linked).not(t.$el)[y]("jumpPage",t.index+1,!0,!0),$(t)}}function h(e){e.$controls.removeClass(L.visible),e.$controlItems.removeClass(L.visible),e.$pagination.removeClass(L.visible)}function v(e){e.$controls.addClass(L.visible),e.$controlItems.addClass(L.visible),e.$pagination.addClass(L.visible)}function $(e){e.$paginationItems.removeClass(L.active).eq(e.index).addClass(L.active),e.infinite?e.$controlItems.addClass(L.visible):e.pageCount<1?e.$controlItems.removeClass(L.visible):(e.$controlItems.addClass(L.visible),e.index<=0?e.$controlPrevious.removeClass(L.visible):(e.index>=e.pageCount-1||!e.single&&e.leftPosition===e.maxMove)&&e.$controlNext.removeClass(L.visible))}function C(i){var a=1;if(i.single)return a;if("array"===e.type(i.show))for(var n in i.show)i.show.hasOwnProperty(n)&&(t.support.matchMedia?i.show[n].mq.matches&&(a=i.show[n].count):i.show[n].width<t.fallbackWidth&&(a=i.show[n].count));else a=i.show;return i.fill&&i.count<a?i.count:a}function b(t,i){var a=t.data;if(H.clearTimer(a.autoTimer),!a.single){var n=a.$canister.css(z).split(",");if(a.leftPosition=parseInt(n[4]),a.$canister.css(E,"").css("will-change","transform"),x(t),a.linked&&!0!==i){var s=t.deltaX/a.pageWidth;a.rtl&&(s*=-1),e(a.linked).not(a.$el)[y]("panStart",s)}}a.isTouching=!0}function x(t,i){var a=t.data;if(!a.single&&(a.touchLeft=k(a,a.leftPosition+t.deltaX),a.infinite&&(t.deltaX>0&&a.touchLeft>a.minClone&&(a.touchLeft-=a.pages[a.pageCount].left),t.deltaX<0&&a.touchLeft<a.maxClone&&(a.touchLeft+=a.pages[a.pageCount].left)),a.$canister.css(z,"translateX("+a.touchLeft+"px)"),a.linked&&!0!==i)){var n=t.deltaX/a.pageWidth;a.rtl&&(n*=-1),e(a.linked).not(a.$el)[y]("pan",n)}}function w(t,i){var a=t.data,n=Math.abs(t.deltaX),s=M(a,t),o=!1;if(a.didPan=!1,!a.single){var r,l,c=Math.abs(a.touchLeft),d=!1,u=a.rtl?"right":"left";if(t.directionX===u)for(r=0,l=a.pages.length;r<l;r++)d=a.pages[r],c>Math.abs(d.left)+20&&(o=r+1);else for(r=a.pages.length-1,l=0;r>=l;r--)d=a.pages[r],c<Math.abs(d.left)&&(o=r-1)}!1===o&&(o=n<50?a.index:a.index+s),o!==a.index&&(a.didPan=!0),o-=a.indexOffset,a.linked&&!0!==i&&e(a.linked).not(a.$el)[y]("panEnd",o),T(a,o)}function P(t,i){var a=t.data,n=M(a,t),s=a.index+n;a.linked&&!0!==i&&e(a.linked).not(a.$el)[y]("swipe",t.directionX),T(a,s)}function T(e,t){e.$canister.css(E,"").css("will-change",""),f(e,t),e.isTouching=!1}function I(t){var i=t.data,a=e(t.currentTarget);if(!i.didPan&&(a.trigger(O.itemClick),i.controller)){var n=i.$items.index(a);W(t,n),i.$subordinate[y]("jumpPage",n+1,!0)}}function _(t){var i=t.data;if(i.enabled&&!i.isTouching){H.clearTimer(i.autoTimer),i.$container.scrollLeft(0);var a,n=e(t.target);n.hasClass(L.item)?a=n:n.parents(X.item).length&&(a=n.parents(X.item).eq(0));for(var s=0;s<i.pageCount;s++)if(i.pages[s].$items.is(a)){f(i,s);break}}}function W(e,t){var i=e.data;if(i.controller){var a=i.$items.eq(t);i.$items.removeClass(L.active),a.addClass(L.active);for(var n=0;n<i.pageCount;n++)if(i.pages[n].$items.is(a)){f(i,n,!0,!0);break}}}function k(e,t){return isNaN(t)?t=0:e.rtl?(t>e.maxMove&&(t=e.maxMove),t<0&&(t=0)):(t<e.maxMove&&(t=e.maxMove),t>0&&(t=0)),t}function M(e,t){return e.rtl?"right"===t.directionX?1:-1:"left"===t.directionX?1:-1}var q=t.Plugin("carousel",{widget:!0,defaults:{autoAdvance:!1,autoHeight:!1,autoTime:8e3,contained:!0,controls:!0,customClass:"",fill:!1,infinite:!0,labels:{next:"Next",previous:"Previous",controls:"Carousel {guid} Controls",pagination:"Carousel {guid} Pagination"},matchHeight:!1,matchWidth:!0,maxWidth:1/0,minWidth:"0px",paged:!1,pagination:!0,rtl:!1,show:1,single:!1,theme:"fs-light"},classes:["ltr","rtl","viewport","wrapper","container","canister","item","item_previous","item_next","controls","controls_custom","control","control_previous","control_next","pagination","page","animated","enabled","visible","active","auto_height","contained","single"],events:{itemClick:"itemClick",update:"update"},methods:{_construct:function(t){var s;t.didPan=!1,t.carouselClasses=[L.base,t.theme,t.customClass,t.rtl?L.rtl:L.ltr],t.maxWidth=t.maxWidth===1/0?"100000px":t.maxWidth,t.mq="(min-width:"+t.minWidth+") and (max-width:"+t.maxWidth+")",t.customControls="object"===e.type(t.controls)&&t.controls.previous&&t.controls.next,t.customPagination="string"===e.type(t.pagination),t.id=this.attr("id"),t.id?t.ariaId=t.id:(t.ariaId=t.rawGuid,this.attr("id",t.ariaId));var r="",l="",c=[L.control,L.control_previous].join(" "),d=[L.control,L.control_next].join(" ");t.controls&&!t.customControls&&(t.labels.controls=t.labels.controls.replace("{guid}",t.numGuid),r+='<div class="'+L.controls+'" aria-label="'+t.labels.controls+'" aria-controls="'+t.ariaId+'">',r+='<button type="button" class="'+c+'" aria-label="'+t.labels.previous+'">'+t.labels.previous+"</button>",r+='<button type="button" class="'+d+'" aria-label="'+t.labels.next+'">'+t.labels.next+"</button>",r+="</div>"),t.pagination&&!t.customPagination&&(t.labels.pagination=t.labels.pagination.replace("{guid}",t.numGuid),l+='<div class="'+L.pagination+'" aria-label="'+t.labels.pagination+'" aria-controls="'+t.ariaId+'" role="navigation">',l+="</div>"),t.autoHeight&&t.carouselClasses.push(L.auto_height),t.contained&&t.carouselClasses.push(L.contained),t.single&&t.carouselClasses.push(L.single),this.addClass(t.carouselClasses.join(" ")).wrapInner('<div class="'+L.wrapper+'" aria-live="polite"><div class="'+L.container+'"><div class="'+L.canister+'"></div></div></div>').append(r).wrapInner('<div class="'+L.viewport+'"></div>').append(l),t.$viewport=this.find(X.viewport).eq(0),t.$container=this.find(X.container).eq(0),t.$canister=this.find(X.canister).eq(0),t.$pagination=this.find(X.pagination).eq(0),t.$controlPrevious=t.$controlNext=e(""),t.customControls?(t.$controls=e(t.controls.container).addClass([L.controls,L.controls_custom].join(" ")),t.$controlPrevious=e(t.controls.previous).addClass(c),t.$controlNext=e(t.controls.next).addClass(d)):(t.$controls=this.find(X.controls).eq(0),t.$controlPrevious=t.$controls.find(X.control_previous),t.$controlNext=t.$controls.find(X.control_next)),t.$controlItems=t.$controlPrevious.add(t.$controlNext),t.customPagination&&(t.$pagination=e(t.pagination).addClass([L.pagination])),t.$paginationItems=t.$pagination.find(X.page),t.index=0,t.enabled=!1,t.leftPosition=0,t.autoTimer=null,t.resizeTimer=null;var u=this.data(j+"-linked");t.linked=!!u&&"[data-"+j+'-linked="'+u+'"]',t.linked&&(t.paged=!0);var m=this.data(j+"-controller-for")||"";if(t.$subordinate=e(m),t.$subordinate.length&&(t.controller=!0),"object"===e.type(t.show)){var p=t.show,g=[],f=[];for(s in p)p.hasOwnProperty(s)&&f.push(s);f.sort(H.sortAsc);for(s in f)f.hasOwnProperty(s)&&g.push({width:parseInt(f[s]),count:p[f[s]],mq:window.matchMedia("(min-width: "+parseInt(f[s])+"px)")});t.show=g}o(t),e.fsMediaquery("bind",t.rawGuid,t.mq,{enter:function(){n.call(t.$el,t)},leave:function(){a.call(t.$el,t)}}),i(),t.carouselClasses.push(L.enabled),t.carouselClasses.push(L.animated)},_destruct:function(t){H.clearTimer(t.autoTimer),H.clearTimer(t.resizeTimer),a.call(this,t),e.fsMediaquery("unbind",t.rawGuid),t.id!==t.ariaId&&this.removeAttr("id"),t.$controlItems.removeClass([X.control,L.control_previous,X.control_next,X.visible].join(" ")).off(O.namespace),t.$images.off(O.namespace),t.$canister.fsTouch("destroy"),t.$items.removeClass([L.item,L.visible,X.item_previous,X.item_next].join(" ")).unwrap().unwrap().unwrap().unwrap(),t.controls&&!t.customControls&&t.$controls.remove(),t.customControls&&t.$controls.removeClass([L.controls,L.controls_custom,L.visible].join(" ")),t.pagination&&!t.customPagination&&t.$pagination.remove(),t.customPagination&&t.$pagination.html("").removeClass([L.pagination,L.visible].join(" ")),this.removeClass(t.carouselClasses.join(" ")),i()},_resize:function(e){H.iterate.call(N,s)},disable:a,enable:n,jump:l,previous:c,next:d,jumpPage:l,previousPage:c,nextPage:d,jumpItem:function(e,t,i,a,n){if(e.enabled){H.clearTimer(e.autoTimer);var s=e.$items.eq(t-1);void 0===n&&(n=!0);for(var o=0;o<e.pageCount;o++)if(e.pages[o].$items.is(s)){f(e,o,n,i,a);break}}},reset:function(e){e.enabled&&r.call(this,e,!1)},resize:s,update:r,panStart:function(e,t){if(H.clearTimer(e.autoTimer),!e.single){e.rtl&&(t*=-1);var i=e.$canister.css(z).split(",");e.leftPosition=parseInt(i[4]),e.$canister.css(E,"none"),x({data:e,deltaX:e.pageWidth*t},!0)}e.isTouching=!0},pan:function(e,t){if(!e.single){e.rtl&&(t*=-1);var i=e.pageWidth*t;e.touchLeft=k(e,e.leftPosition+i),e.$canister.css(z,"translateX("+e.touchLeft+"px)")}},panEnd:function(e,t){T(e,t)},swipe:function(e,t){P({data:e,directionX:t},!0)}}}),j=q.namespace,y=q.namespaceClean,X=q.classes,L=X.raw,O=q.events,H=q.functions,N=[],z=t.transform,E=t.transition});